$(document).ready(function () { 
	
	$(document).ajaxStart(function(){ $("body").css('cursor', 'progress'); });
	$(document).ajaxStop(function(){ $("body").css('cursor', ''); });
	
	// fading notice, error messages
    $(".notice, .error").delay(4000).fadeOut(500);
	
	// toggle favorites
	$("span.favorite_link a").live('ajax:complete', function(xhr, response){
    var media_entry_id = $(this).parent().attr("id").slice(4); // TODO $(this).closest(".item_box").attr("rel");
    $("span#fav_" + media_entry_id).html(response.responseText);
  }).live("ajax:beforeSend", function() {
    $(this).parent().find(".button_favorit_off").replaceWith($.tmpl("tmpl/loading_img"));
    $(this).parent().find(".button_favorit_on").replaceWith($.tmpl("tmpl/loading_img"));
  });

	$("#menu").flickrmenu({ arrowPic: "<%= image_path 'icons/arrow.png' %>",
							arrowPicA: "<%= image_path 'icons/arrow_select.png' %>",
							arrowPicH: "<%= image_path 'icons/arrow_hover.png' %>" });

    // OPTIMIZE Action Bar for media_entry and media_set templates
    $("a[panel]").click(function(){
      to_open = !$(this).hasClass("active");
      $("a.active[panel]").each(function () {
        $(this).removeClass("active");
        $(this).css("background", "");
        $("div#"+$(this).attr("panel")+"-panel").slideUp("slow");
      });
      if(to_open){
        $(this).addClass("active");
        $("div#"+$(this).attr("panel")+"-panel").slideDown("slow");
      }
      return false;
    });

});

/*
// TODO .uniq_on("id")
Array.prototype.getUnique = function () {
	var o = new Object();
	var i, e;
	for (i = 0; e = this[i]; i++) {o[e] = 1};
	var a = new Array();
	for (e in o) {a.push (e)};
	return a;
};
*/
	
function isArray(a) {
  return Object.prototype.toString.apply(a) === '[object Array]';
}




